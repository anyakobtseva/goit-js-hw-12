{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport iziToast from 'izitoast';\nimport axios from 'axios';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst PIXABAY_URL = 'https://pixabay.com/api/';\nconst API_KEY = import.meta.env.VITE_API_KEY;\nconst ligthbox = new SimpleLightbox('.gallery a');\nconst loadMoreBt = document.querySelector('.bt');\nlet totalPages;\n\niziToast.settings({\n  timeout: 3000,\n  resetOnHover: true,\n  icon: null,\n  position: 'topRight',\n  close: false,\n  closeOnClick: true,\n  closeOnEscape: true,\n});\n\nconst config = {\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    per_page: 40,\n    orientation: 'horizontal',\n    safesearch: true,\n    page: 1,\n    q: '',\n  },\n};\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  const query = event.target.search.value;\n  config.params.q = query;\n  config.params.page = 1;\n  gallery.innerHTML = '';\n  loader.style.display = 'flex';\n\n  await renderGallery(config);\n});\n\nloadMoreBt.addEventListener('click', async () => {\n  config.params.page += 1;\n  await renderGallery(config);\n  const item = document.querySelector('.gallery-item');\n  const { height } = item.getBoundingClientRect();\n  window.scrollBy({\n    top: height * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n});\n\nconst renderGallery = async config => {\n  try {\n    const images = (await axios.get(PIXABAY_URL, config)).data;\n    if (images.hits.length === 0) {\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please, try again!'\n      );\n    }\n    if (config.params.page == 1) {\n      totalPages = Math.ceil(images.totalHits / config.params.per_page);\n    }\n    gallery.append(...images.hits.map(image => createGalleryItem(image)));\n    ligthbox.refresh();\n    if (config.params.page == totalPages) {\n      throw new Error(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n    loadMoreBt.style.display = 'block';\n  } catch (error) {\n    loadMoreBt.style.display = 'none';\n    iziToast.error({\n      message: error.message,\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n};\n\nconst createGalleryItem = image => {\n  const liEl = document.createElement('li');\n  liEl.className = 'gallery-item';\n  const linkEl = document.createElement('a');\n  linkEl.className = 'gallery-link';\n  linkEl.href = image.largeImageURL;\n  liEl.appendChild(linkEl);\n  const imEl = document.createElement('img');\n  imEl.className = 'gallery-image';\n  imEl.src = image.webformatURL;\n  imEl.title = image.tags;\n  imEl.dataset.source = image.largeImageURL;\n  const ulEl = document.createElement('ul');\n  ulEl.className = 'tags';\n\n  const lis = generateTags({\n    Likes: image.likes,\n    Views: image.views,\n    Comments: image.comments,\n    Downloads: image.downloads,\n  });\n\n  linkEl.appendChild(imEl);\n  ulEl.append(...lis);\n  linkEl.appendChild(ulEl);\n  return liEl;\n};\n\nconst generateTags = obj => {\n  const lis = [];\n  Object.keys(obj).forEach(key => {\n    const li = document.createElement('li');\n    li.textContent = key;\n    const p = document.createElement('p');\n    p.textContent = obj[key];\n    li.appendChild(p);\n    lis.push(li);\n  });\n\n  return lis;\n};\n"],"names":["form","gallery","loader","PIXABAY_URL","API_KEY","ligthbox","SimpleLightbox","loadMoreBt","totalPages","iziToast","config","event","query","renderGallery","item","height","images","axios","image","createGalleryItem","error","liEl","linkEl","imEl","ulEl","lis","generateTags","obj","key","li","p"],"mappings":"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"}